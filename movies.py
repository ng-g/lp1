import pandas as pd
df = pd.read_csv("ratings_tiny.csv")
movieDict = {}
for index,row in df.iterrows():
	if row["movieId"] not in movieDict:
		movieDict[row["movieId"]] = []
		movieDict[row["movieId"]].append(row["rating"])
	else:
		movieDict[row["movieId"]].append(row["rating"])
for movie,ratings in movieDict.items():
	print movie,sum(ratings)/len(ratings)


# **************************OUTPUT**********************************************

# 	chanchald@chanchald-X553SA:~$ cd Desktop
# chanchald@chanchald-X553SA:~/Desktop$ cd p5
# chanchald@chanchald-X553SA:~/Desktop/p5$ python avgrating.py
# 1.0 4.25
# 5.0 3.0
# 2054.0 2.5
# 7.0 2.5
# 11.0 3.0
# 6157.0 3.0
# 122904.0 1.0
# 25.0 3.0
# 1370.0 3.5
# 32.0 2.75
# 34.0 4.0
# 4443.0 4.0
# 4103.0 4.0
# 44.0 3.0
# 47.0 3.75
# 51255.0 2.5
# 58.0 3.0
# 116797.0 4.5
# 2110.0 2.0
# 64.0 4.0
# 88129.0 4.0
# 30793.0 2.5
# 79.0 4.0
# 50872.0 4.0
# 110.0 2.25
# 2163.0 2.0
# 4226.0 3.375
# 141.0 3.0
# 4238.0 3.75
# 2193.0 2.0
# 147.0 4.5
# 4246.0 4.0
# 153.0 3.0
# 157.0 2.0
# 165.0 3.75
# 5120.0 2.0
# 170.0 3.0
# 42013.0 2.0
# 8368.0 4.0
# 6333.0 4.0
# 2240.0 3.0
# 4291.0 2.0
# 2245.0 3.5
# 208.0 3.0
# 4306.0 3.75
# 1059.0 5.0
# 69844.0 4.25
# 6365.0 3.0
# 223.0 4.0
# 231.0 2.5
# 6377.0 3.5
# 2300.0 2.0
# 260.0 3.5
# 2313.0 3.0
# 4366.0 3.0
# 4367.0 2.75
# 2321.0 4.0
# 4370.0 2.5
# 2324.0 5.0
# 6624.0 2.5
# 92439.0 5.0
# 2334.0 3.0
# 2338.0 2.0
# 293.0 5.0
# 296.0 4.333333333333333
# 2355.0 4.25
# 318.0 4.5
# 2443.0 4.0
# 339.0 5.0
# 8533.0 4.0
# 342.0 5.0
# 344.0 3.5
# 2395.0 4.5
# 2396.0 5.0
# 349.0 5.0
# 356.0 4.0
# 364.0 3.0
# 88125.0 4.5
# 2416.0 3.0
# 4466.0 3.0
# 377.0 4.0
# 4474.0 3.0
# 380.0 5.0
# 45442.0 3.0
# 6539.0 3.75
# 415.0 4.0
# 420.0 1.0
# 2469.0 3.0
# 106920.0 3.5
# 2474.0 2.0
# 4541.0 4.0
# 457.0 3.75
# 4563.0 3.0
# 3016.0 3.0
# 8665.0 4.0
# 4571.0 3.0
# 480.0 3.25
# 2541.0 3.0
# 497.0 4.0
# 500.0 3.0
# 98809.0 2.5
# 2565.0 4.0
# 520.0 2.0
# 2571.0 3.625
# 527.0 4.25
# 2581.0 3.0
# 541.0 5.0
# 4638.0 3.0
# 4643.0 2.0
# 2596.0 4.0
# 2600.0 2.0
# 553.0 4.0
# 4654.0 3.0
# 96821.0 5.0
# 2628.0 5.0
# 585.0 2.0
# 588.0 5.0
# 590.0 3.0
# 80463.0 3.5
# 2640.0 2.0
# 593.0 4.0
# 594.0 3.0
# 595.0 5.0
# 605.0 4.0
# 41566.0 2.0
# 45672.0 2.0
# 1127.0 3.5
# 2670.0 4.0
# 628.0 4.0
# 2683.0 3.0
# 6568.0 4.0
# 2692.0 4.0
# 4886.0 4.0
# 2694.0 1.0
# 647.0 4.0
# 648.0 4.0
# 653.0 4.0
# 2706.0 4.0
# 2707.0 5.0
# 2710.0 2.0
# 2712.0 3.0
# 2716.0 4.0
# 33437.0 3.0
# 43679.0 3.0
# 88744.0 1.5
# 60074.0 1.0
# 4787.0 2.0
# 72378.0 2.5
# 2762.0 3.875
# 2763.0 4.0
# 6870.0 3.5
# 736.0 3.0
# 750.0 4.0
# 4848.0 3.0
# 54001.0 3.0
# 2805.0 3.0
# 762.0 3.0
# 99114.0 3.0
# 8961.0 2.5
# 68358.0 5.0
# 780.0 3.0
# 4878.0 3.6666666666666665
# 784.0 2.0
# 4881.0 4.0
# 786.0 1.0
# 788.0 1.0
# 37653.0 3.0
# 6934.0 2.0
# 6942.0 3.5
# 4896.0 4.0
# 4901.0 3.0
# 2858.0 4.5
# 2875.0 4.0
# 2877.0 1.0
# 832.0 2.0
# 2881.0 3.0
# 852.0 2.0
# 4954.0 3.0
# 4956.0 4.0
# 37727.0 3.0
# 4963.0 3.1666666666666665
# 2918.0 5.0
# 2919.0 3.0
# 4971.0 2.0
# 4973.0 4.75
# 4979.0 4.25
# 4980.0 2.0
# 4993.0 4.5
# 4995.0 4.0
# 150.0 4.0
# 5002.0 2.0
# 908.0 5.0
# 2959.0 3.6666666666666665
# 5008.0 5.0
# 5013.0 3.0
# 5016.0 3.5
# 5026.0 2.0
# 5033.0 1.0
# 2987.0 4.0
# 5036.0 3.0
# 3004.0 1.0
# 3005.0 3.0
# 5054.0 4.0
# 5064.0 3.75
# 3036.0 3.0
# 7153.0 4.5
# 35836.0 3.0
# 54272.0 4.0
# 33794.0 4.0
# 5125.0 2.0
# 3079.0 5.0
# 3082.0 3.0
# 1037.0 3.0
# 3091.0 4.0
# 3101.0 3.0
# 5151.0 3.0
# 3107.0 2.0
# 3114.0 4.5
# 1073.0 4.0
# 7347.0 3.5
# 27700.0 4.5
# 1079.0 2.0
# 1089.0 3.5
# 1092.0 3.0
# 1097.0 4.0
# 3146.0 3.0
# 3147.0 3.0
# 3156.0 5.0
# 3160.0 4.0
# 3175.0 5.0
# 3197.0 2.0
# 3198.0 4.0
# 3203.0 4.0
# 37741.0 2.5
# 1183.0 4.0
# 1188.0 4.5
# 44199.0 4.0
# 1193.0 5.0
# 858.0 4.666666666666667
# 1197.0 4.25
# 1198.0 3.5
# 1201.0 5.0
# 5299.0 5.0
# 1204.0 5.0
# 3255.0 3.0
# 1210.0 3.3333333333333335
# 1211.0 3.0
# 58559.0 4.5
# 7361.0 2.0
# 1221.0 5.0
# 1225.0 4.0
# 1228.0 3.0
# 1230.0 5.0
# 1233.0 4.0
# 40148.0 2.5
# 3285.0 3.0
# 1246.0 4.75
# 1573.0 3.5
# 3298.0 3.0
# 5349.0 4.0
# 1254.0 5.0
# 54503.0 3.5
# 1262.0 4.0
# 1263.0 5.0
# 1265.0 2.75
# 1266.0 5.0
# 1270.0 3.6666666666666665
# 4308.0 5.0
# 1276.0 3.0
# 5378.0 2.5
# 5380.0 4.0
# 1287.0 4.0
# 1291.0 3.5
# 1292.0 5.0
# 7439.0 3.0
# 1302.0 5.0
# 1304.0 3.25
# 3354.0 1.0
# 79132.0 3.0
# 3359.0 4.0
# 5418.0 3.5
# 73017.0 5.0
# 1339.0 1.0
# 1343.0 3.0
# 5445.0 3.0
# 1356.0 5.0
# 3408.0 4.166666666666667
# 3409.0 3.0
# 5459.0 3.5
# 68954.0 3.0
# 33679.0 3.5
# 912.0 4.0
# 91500.0 2.5
# 1391.0 2.5
# 3440.0 3.0
# 1404.0 1.0
# 1405.0 4.0
# 5502.0 3.0
# 91529.0 4.5
# 1422.0 4.0
# 40339.0 4.0
# 3476.0 4.0
# 91542.0 5.0
# 1431.0 3.0
# 1207.0 4.0
# 3996.0 4.0
# 4681.0 1.0
# 3513.0 3.5
# 1475.0 3.0
# 3527.0 5.0
# 5577.0 5.0
# 3535.0 3.75
# 3538.0 3.0
# 1499.0 3.0
# 592.0 4.0
# 3555.0 4.0
# 5618.0 4.0
# 1527.0 3.75
# 3578.0 4.0
# 6058.0 3.5
# 44555.0 4.0
# 1552.0 2.0
# 5669.0 4.0
# 3623.0 2.0
# 5679.0 3.0
# 2985.0 4.0
# 3634.0 5.0
# 1591.0 4.0
# 1597.0 3.0
# 3660.0 4.0
# 1617.0 4.0
# 3671.0 3.0
# 1626.0 3.0
# 39183.0 3.0
# 3679.0 4.0
# 63082.0 3.5
# 1644.0 3.0
# 1645.0 4.0
# 1653.0 3.25
# 3717.0 3.5
# 1676.0 0.5
# 89745.0 2.5
# 1682.0 4.5
# 36513.0 3.0
# 3751.0 4.0
# 3752.0 3.0
# 3753.0 4.0
# 968.0 4.0
# 5810.0 2.0
# 5816.0 4.0
# 1721.0 4.0
# 1732.0 3.0
# 134853.0 2.5
# 3785.0 3.0
# 3793.0 4.0
# 3798.0 4.0
# 5872.0 3.0
# 1792.0 1.0
# 3841.0 4.0
# 5902.0 3.5
# 3868.0 4.0
# 1837.0 1.0
# 5952.0 4.5
# 3908.0 2.0
# 3909.0 3.0
# 1876.0 3.0
# 1882.0 2.0
# 5989.0 4.5
# 5991.0 4.5
# 3948.0 2.5
# 40815.0 2.5
# 1909.0 4.0
# 1911.0 4.0
# 3967.0 4.5
# 3969.0 3.5
# 1923.0 4.0
# 3977.0 3.0
# 3986.0 1.0
# 1945.0 5.0
# 4361.0 2.0
# 112552.0 5.0
# 81834.0 4.0
# 1965.0 3.0
# 4014.0 4.25
# 1968.0 3.3333333333333335
# 59315.0 5.0
# 4022.0 3.75
# 4027.0 4.25
# 4036.0 1.0
# 55247.0 2.0
# 4052.0 3.5
# 2019.0 5.0
# 2022.0 3.0
# 2023.0 5.0
# 2028.0 4.0
# 4084.0 2.0
# 4085.0 3.0
# 106489.0 4.0
# chanchald@chanchald-X553SA:~/Desktop/p5$ 
